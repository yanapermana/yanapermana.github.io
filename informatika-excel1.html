<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuis Excel Interaktif</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .answer-option {
            transition: all 0.3s ease;
        }
        
        .answer-option:hover:not(.correct):not(.incorrect):not(:disabled) {
            transform: translateX(8px);
        }
        
        .correct {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: #059669;
        }
        
        .incorrect {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border-color: #dc2626;
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        .score-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app-wrapper" class="w-full h-full overflow-auto">
   <div id="quiz-container" class="min-h-full w-full"></div>
  </div>
  <script>
        const defaultConfig = {
            background_color: "#f0f4f8",
            card_color: "#ffffff",
            text_color: "#1e293b",
            primary_button_color: "#3b82f6",
            secondary_button_color: "#8b5cf6",
            font_family: "Inter",
            font_size: 16,
            quiz_title: "Kuis Excel Interaktif",
            quiz_subtitle: "Uji pengetahuan Anda tentang rumus-rumus Excel",
            start_button_text: "Mulai Kuis",
            next_button_text: "Soal Selanjutnya",
            finish_button_text: "Lihat Hasil"
        };

        const quizData = [
            {
                question: "Rumus Excel yang digunakan untuk penjumlahan adalah?",
                options: ["=ADD()", "=SUM()", "=PLUS()", "=TOTAL()", "=TAMBAH()"],
                correct: 1
            },
            {
                question: "Rumus untuk pengurangan di Excel adalah?",
                options: ["=MINUS()", "=SUB()", "Menggunakan operator -", "=KURANG()", "=SUBTRACT()"],
                correct: 2
            },
            {
                question: "Operator yang digunakan untuk perkalian di Excel adalah?",
                options: ["x", "+", "/", "*", "^"],
                correct: 3
            },
            {
                question: "Operator pembagian di Excel adalah?",
                options: [":", "\\", "/", "%", "Ã·"],
                correct: 2
            },
            {
                question: "Untuk menjumlahkan sel A1 sampai A10, rumus yang tepat adalah?",
                options: ["=SUM(A1-A10)", "=SUM(A1:A10)", "=SUM(A1+A10)", "=ADD(A1:A10)", "=TOTAL(A1-A10)"],
                correct: 1
            },
            {
                question: "Rumus untuk menjumlahkan data dari Sheet1 ke Sheet2 adalah?",
                options: ["=SUM(Sheet1+Sheet2!A1)", "=Sheet1!A1+Sheet2!A1", "=SUM(Sheet1:Sheet2)", "=ADD(Sheet1,Sheet2)", "=COMBINE(Sheet1:Sheet2)"],
                correct: 1
            },
            {
                question: "Rumus SUMIF digunakan untuk?",
                options: ["Menjumlahkan semua data", "Menjumlahkan data dengan kriteria tertentu", "Menghitung rata-rata", "Mencari nilai maksimum", "Mengurutkan data"],
                correct: 1
            },
            {
                question: "Rumus yang digunakan untuk menjumlahkan data dengan banyak kriteria adalah?",
                options: ["SUMIF", "SUMIFS", "COUNTIF", "AVERAGEIF", "MULTISUM"],
                correct: 1
            },
            {
                question: "Rumus ROUND digunakan untuk?",
                options: ["Menghapus angka", "Membulatkan angka", "Menambah angka", "Mengalikan angka", "Membagi angka"],
                correct: 1
            },
            {
                question: "Untuk menghilangkan angka di belakang koma, fungsi yang tepat adalah?",
                options: ["ROUND", "TRUNC atau INT", "DELETE", "REMOVE", "CLEAR"],
                correct: 1
            },
            {
                question: "Rumus MROUND digunakan untuk?",
                options: ["Membulatkan ke atas", "Membulatkan ke bawah", "Membulatkan pada kelipatan tertentu", "Menghapus desimal", "Membuat angka acak"],
                correct: 2
            },
            {
                question: "Fungsi untuk membuat angka acak (random) di Excel adalah?",
                options: ["=RANDOM()", "=RAND()", "=RND()", "=ACAK()", "=NUMBER()"],
                correct: 1
            },
            {
                question: "Untuk membuat angka random integer antara 1-100, rumus yang tepat adalah?",
                options: ["=RAND(1,100)", "=RANDOM(1:100)", "=RANDBETWEEN(1,100)", "=INT(RAND(100))", "=RANDINT(1,100)"],
                correct: 2
            },
            {
                question: "Cara membuat angka random yang tidak kembar menggunakan kombinasi fungsi?",
                options: ["RAND + UNIQUE", "RANDBETWEEN + IF", "RAND + RANK", "RANDOM + DISTINCT", "RANDBETWEEN + COUNT"],
                correct: 2
            },
            {
                question: "Untuk membuat pola angka berulang (1,1,1,2,2,2,3,3,3), fungsi yang bisa digunakan adalah?",
                options: ["REPEAT", "SEQUENCE + REPT", "INT + CEILING", "LOOP + COUNT", "DUPLICATE"],
                correct: 1
            },
            {
                question: "Untuk membuat pola (1,2,3,1,2,3,1,2,3), fungsi yang tepat adalah?",
                options: ["CYCLE", "MOD + SEQUENCE", "REPEAT + LOOP", "PATTERN", "ITERATE"],
                correct: 1
            },
            {
                question: "Rumus untuk menghitung sisa pembagian di Excel adalah?",
                options: ["REMAINDER", "MOD", "REST", "SISA", "DIVIDE"],
                correct: 1
            },
            {
                question: "Untuk menghitung 15 MOD 4, hasilnya adalah?",
                options: ["1", "2", "3", "4", "0"],
                correct: 2
            },
            {
                question: "Untuk menghitung persentase di Excel, rumus yang tepat adalah?",
                options: ["=nilai*100", "=(nilai/total)*100", "=PERCENT(nilai)", "=nilai%total", "=PERCENTAGE(nilai,total)"],
                correct: 1
            },
            {
                question: "Jika A1=80 dan B1=100, rumus untuk menghitung persentase A1 dari B1 adalah?",
                options: ["=A1/B1", "=(A1/B1)*100%", "=A1/B1*100", "Semua benar untuk menampilkan persen", "=PERCENT(A1,B1)"],
                correct: 3
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answeredQuestions = 0;
        let quizStarted = false;

        function onConfigChange(config) {
            const baseFontSize = config.font_size || defaultConfig.font_size;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseFontStack = 'system-ui, -apple-system, sans-serif';
            
            document.body.style.backgroundColor = config.background_color || defaultConfig.background_color;
            document.body.style.color = config.text_color || defaultConfig.text_color;
            document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
            document.body.style.fontSize = `${baseFontSize}px`;
            
            renderQuiz();
        }

        function renderQuiz() {
            const config = window.elementSdk?.config || defaultConfig;
            const container = document.getElementById('quiz-container');
            
            if (!quizStarted) {
                container.innerHTML = `
                    <div class="flex items-center justify-center min-h-full p-6">
                        <div class="w-full max-w-2xl fade-in" style="background-color: ${config.card_color || defaultConfig.card_color}; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); padding: 3rem;">
                            <div class="text-center">
                                <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 2}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 1rem;">
                                    ${config.quiz_title || defaultConfig.quiz_title}
                                </div>
                                <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 1.125}px; color: ${config.text_color || defaultConfig.text_color}; opacity: 0.7; margin-bottom: 2rem;">
                                    ${config.quiz_subtitle || defaultConfig.quiz_subtitle}
                                </div>
                                <div style="background: linear-gradient(135deg, ${config.secondary_button_color || defaultConfig.secondary_button_color}20 0%, ${config.primary_button_color || defaultConfig.primary_button_color}20 100%); border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
                                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 1.25}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 1rem;">
                                        ðŸ“Š Informasi Kuis
                                    </div>
                                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 1}px; color: ${config.text_color || defaultConfig.text_color}; opacity: 0.8;">
                                        âœ… 20 soal pilihan ganda<br>
                                        âœ… Jawaban langsung ditampilkan<br>
                                        âœ… Skor akhir di tampilan hasil
                                    </div>
                                </div>
                                <button id="start-btn" style="background: linear-gradient(135deg, ${config.primary_button_color || defaultConfig.primary_button_color} 0%, ${config.secondary_button_color || defaultConfig.secondary_button_color} 100%); color: white; font-size: ${(config.font_size || defaultConfig.font_size) * 1.125}px; font-weight: 600; padding: 1rem 3rem; border-radius: 12px; border: none; cursor: pointer; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3); transition: transform 0.2s;">
                                    ${config.start_button_text || defaultConfig.start_button_text} ðŸš€
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                const startBtn = document.getElementById('start-btn');
                startBtn.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                });
                startBtn.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
                startBtn.addEventListener('click', startQuiz);
            } else if (currentQuestion < quizData.length) {
                renderQuestion();
            } else {
                renderResults();
            }
        }

        function startQuiz() {
            quizStarted = true;
            currentQuestion = 0;
            score = 0;
            answeredQuestions = 0;
            renderQuiz();
        }

        function renderQuestion() {
            const config = window.elementSdk?.config || defaultConfig;
            const container = document.getElementById('quiz-container');
            const question = quizData[currentQuestion];
            const progress = ((currentQuestion) / quizData.length) * 100;
            
            container.innerHTML = `
                <div class="flex items-center justify-center min-h-full p-6">
                    <div class="w-full max-w-3xl fade-in">
                        <div style="background-color: ${config.card_color || defaultConfig.card_color}; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); padding: 2.5rem; margin-bottom: 1.5rem;">
                            <div style="margin-bottom: 1.5rem;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <span style="font-size: ${(config.font_size || defaultConfig.font_size) * 0.875}px; font-weight: 600; color: ${config.primary_button_color || defaultConfig.primary_button_color};">
                                        Soal ${currentQuestion + 1} dari ${quizData.length}
                                    </span>
                                    <span style="font-size: ${(config.font_size || defaultConfig.font_size) * 0.875}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; opacity: 0.6;">
                                        ${Math.round(progress)}%
                                    </span>
                                </div>
                                <div style="width: 100%; height: 8px; background-color: ${config.background_color || defaultConfig.background_color}; border-radius: 4px; overflow: hidden;">
                                    <div class="progress-bar" style="width: ${progress}%; height: 100%; background: linear-gradient(90deg, ${config.primary_button_color || defaultConfig.primary_button_color} 0%, ${config.secondary_button_color || defaultConfig.secondary_button_color} 100%);"></div>
                                </div>
                            </div>
                            
                            <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 1.25}px; font-weight: 600; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 2rem; line-height: 1.6;">
                                ${question.question}
                            </div>
                            
                            <div id="options-container" style="display: flex; flex-direction: column; gap: 1rem;">
                                ${question.options.map((option, index) => `
                                    <button 
                                        class="answer-option" 
                                        data-index="${index}"
                                        style="background-color: ${config.background_color || defaultConfig.background_color}; color: ${config.text_color || defaultConfig.text_color}; font-size: ${(config.font_size || defaultConfig.font_size) * 1}px; padding: 1.25rem; border-radius: 12px; border: 2px solid transparent; cursor: pointer; text-align: left; font-weight: 500; width: 100%;">
                                        <span style="display: inline-block; width: 2rem; height: 2rem; background-color: ${config.card_color || defaultConfig.card_color}; border-radius: 50%; text-align: center; line-height: 2rem; margin-right: 1rem; font-weight: 600; color: ${config.primary_button_color || defaultConfig.primary_button_color};">
                                            ${String.fromCharCode(65 + index)}
                                        </span>
                                        ${option}
                                    </button>
                                `).join('')}
                            </div>
                            
                            <div id="feedback-container" style="margin-top: 1.5rem; min-height: 60px;"></div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button id="next-btn" style="display: none; background: linear-gradient(135deg, ${config.primary_button_color || defaultConfig.primary_button_color} 0%, ${config.secondary_button_color || defaultConfig.secondary_button_color} 100%); color: white; font-size: ${(config.font_size || defaultConfig.font_size) * 1}px; font-weight: 600; padding: 1rem 2.5rem; border-radius: 12px; border: none; cursor: pointer; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);">
                                ${currentQuestion < quizData.length - 1 ? (config.next_button_text || defaultConfig.next_button_text) : (config.finish_button_text || defaultConfig.finish_button_text)} â†’
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            const options = container.querySelectorAll('.answer-option');
            options.forEach(option => {
                option.addEventListener('click', handleAnswer);
            });
            
            const nextBtn = document.getElementById('next-btn');
            nextBtn.addEventListener('click', nextQuestion);
        }

        function handleAnswer(e) {
            const config = window.elementSdk?.config || defaultConfig;
            const selectedIndex = parseInt(e.currentTarget.dataset.index);
            const question = quizData[currentQuestion];
            const isCorrect = selectedIndex === question.correct;
            
            if (isCorrect) {
                score++;
            }
            answeredQuestions++;
            
            const options = document.querySelectorAll('.answer-option');
            options.forEach((option, index) => {
                option.disabled = true;
                option.style.cursor = 'not-allowed';
                
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && !isCorrect) {
                    option.classList.add('incorrect');
                } else {
                    option.style.opacity = '0.5';
                }
            });
            
            const feedbackContainer = document.getElementById('feedback-container');
            feedbackContainer.innerHTML = `
                <div style="background-color: ${isCorrect ? '#10b98120' : '#ef444420'}; border-left: 4px solid ${isCorrect ? '#10b981' : '#ef4444'}; padding: 1rem; border-radius: 8px;">
                    <div style="font-weight: 600; font-size: ${(config.font_size || defaultConfig.font_size) * 1.125}px; color: ${isCorrect ? '#059669' : '#dc2626'}; margin-bottom: 0.5rem;">
                        ${isCorrect ? 'âœ“ Benar!' : 'âœ— Salah'}
                    </div>
                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 0.875}px; color: ${config.text_color || defaultConfig.text_color}; opacity: 0.8;">
                        ${isCorrect ? 'Jawaban Anda tepat!' : `Jawaban yang benar: <strong>${question.options[question.correct]}</strong>`}
                    </div>
                </div>
            `;
            
            document.getElementById('next-btn').style.display = 'inline-block';
        }

        function nextQuestion() {
            currentQuestion++;
            renderQuiz();
        }

        function renderResults() {
            const config = window.elementSdk?.config || defaultConfig;
            const container = document.getElementById('quiz-container');
            const percentage = (score / quizData.length) * 100;
            let grade = '';
            let message = '';
            
            if (percentage >= 90) {
                grade = 'A';
                message = 'Luar Biasa! ðŸŒŸ';
            } else if (percentage >= 80) {
                grade = 'B';
                message = 'Bagus Sekali! ðŸ‘';
            } else if (percentage >= 70) {
                grade = 'C';
                message = 'Baik! ðŸ‘';
            } else if (percentage >= 60) {
                grade = 'D';
                message = 'Cukup! ðŸ“š';
            } else {
                grade = 'E';
                message = 'Perlu Belajar Lagi! ðŸ’ª';
            }
            
            container.innerHTML = `
                <div class="flex items-center justify-center min-h-full p-6">
                    <div class="w-full max-w-2xl fade-in">
                        <div class="score-card" style="border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); padding: 3rem; margin-bottom: 2rem; text-align: center;">
                            <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 3}px; font-weight: 700; color: white; margin-bottom: 1rem;">
                                ${percentage.toFixed(0)}%
                            </div>
                            <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 2}px; font-weight: 600; color: white; margin-bottom: 0.5rem;">
                                ${message}
                            </div>
                            <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 1.25}px; color: white; opacity: 0.9;">
                                Nilai: ${grade}
                            </div>
                        </div>
                        
                        <div style="background-color: ${config.card_color || defaultConfig.card_color}; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); padding: 2.5rem;">
                            <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 1.5}px; font-weight: 700; color: ${config.text_color || defaultConfig.text_color}; margin-bottom: 2rem; text-align: center;">
                                Hasil Detail
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                                <div style="background-color: ${config.background_color || defaultConfig.background_color}; padding: 1.5rem; border-radius: 12px; text-align: center;">
                                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 2}px; font-weight: 700; color: #10b981; margin-bottom: 0.5rem;">
                                        ${score}
                                    </div>
                                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 0.875}px; color: ${config.text_color || defaultConfig.text_color}; opacity: 0.7;">
                                        Jawaban Benar
                                    </div>
                                </div>
                                
                                <div style="background-color: ${config.background_color || defaultConfig.background_color}; padding: 1.5rem; border-radius: 12px; text-align: center;">
                                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 2}px; font-weight: 700; color: #ef4444; margin-bottom: 0.5rem;">
                                        ${quizData.length - score}
                                    </div>
                                    <div style="font-size: ${(config.font_size || defaultConfig.font_size) * 0.875}px; color: ${config.text_color || defaultConfig.text_color}; opacity: 0.7;">
                                        Jawaban Salah
                                    </div>
                                </div>
                            </div>
                            
                            <div style="text-align: center;">
                                <button id="restart-btn" style="background: linear-gradient(135deg, ${config.primary_button_color || defaultConfig.primary_button_color} 0%, ${config.secondary_button_color || defaultConfig.secondary_button_color} 100%); color: white; font-size: ${(config.font_size || defaultConfig.font_size) * 1.125}px; font-weight: 600; padding: 1rem 3rem; border-radius: 12px; border: none; cursor: pointer; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);">
                                    ðŸ”„ Coba Lagi
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('restart-btn').addEventListener('click', () => {
                quizStarted = false;
                currentQuestion = 0;
                score = 0;
                answeredQuestions = 0;
                renderQuiz();
            });
        }

        async function init() {
            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig: defaultConfig,
                    onConfigChange: onConfigChange,
                    mapToCapabilities: (config) => ({
                        recolorables: [
                            {
                                get: () => config.background_color || defaultConfig.background_color,
                                set: (value) => {
                                    config.background_color = value;
                                    window.elementSdk.setConfig({ background_color: value });
                                }
                            },
                            {
                                get: () => config.card_color || defaultConfig.card_color,
                                set: (value) => {
                                    config.card_color = value;
                                    window.elementSdk.setConfig({ card_color: value });
                                }
                            },
                            {
                                get: () => config.text_color || defaultConfig.text_color,
                                set: (value) => {
                                    config.text_color = value;
                                    window.elementSdk.setConfig({ text_color: value });
                                }
                            },
                            {
                                get: () => config.primary_button_color || defaultConfig.primary_button_color,
                                set: (value) => {
                                    config.primary_button_color = value;
                                    window.elementSdk.setConfig({ primary_button_color: value });
                                }
                            },
                            {
                                get: () => config.secondary_button_color || defaultConfig.secondary_button_color,
                                set: (value) => {
                                    config.secondary_button_color = value;
                                    window.elementSdk.setConfig({ secondary_button_color: value });
                                }
                            }
                        ],
                        borderables: [],
                        fontEditable: {
                            get: () => config.font_family || defaultConfig.font_family,
                            set: (value) => {
                                config.font_family = value;
                                window.elementSdk.setConfig({ font_family: value });
                            }
                        },
                        fontSizeable: {
                            get: () => config.font_size || defaultConfig.font_size,
                            set: (value) => {
                                config.font_size = value;
                                window.elementSdk.setConfig({ font_size: value });
                            }
                        }
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ["quiz_title", config.quiz_title || defaultConfig.quiz_title],
                        ["quiz_subtitle", config.quiz_subtitle || defaultConfig.quiz_subtitle],
                        ["start_button_text", config.start_button_text || defaultConfig.start_button_text],
                        ["next_button_text", config.next_button_text || defaultConfig.next_button_text],
                        ["finish_button_text", config.finish_button_text || defaultConfig.finish_button_text]
                    ])
                });
            }
            
            onConfigChange(window.elementSdk?.config || defaultConfig);
        }

        init();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ac1891046d49de3',t:'MTc2NTQxOTk2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
