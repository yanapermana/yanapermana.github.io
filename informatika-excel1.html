<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuis Excel Interaktif</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .question-card {
            transition: all 0.3s ease;
        }
        
        .option-button {
            transition: all 0.2s ease;
        }
        
        .option-button:hover:not(:disabled) {
            transform: translateX(8px);
        }
        
        .correct-answer {
            background-color: #10b981 !important;
            color: white !important;
            border-color: #059669 !important;
        }
        
        .wrong-answer {
            background-color: #ef4444 !important;
            color: white !important;
            border-color: #dc2626 !important;
        }
        
        .disabled-option {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="w-full h-full overflow-auto"></div>
  <script>
        const defaultConfig = {
            quiz_title: "Kuis Excel Interaktif",
            quiz_subtitle: "Uji Pengetahuan Anda tentang Rumus-Rumus Excel",
            background_color: "#f0f9ff",
            card_background: "#ffffff",
            primary_color: "#0284c7",
            text_color: "#1e293b",
            accent_color: "#06b6d4"
        };

        const questions = [
            {
                id: 1,
                question: "Rumus yang benar untuk menjumlahkan sel A1 dan B1 di Excel adalah:",
                options: [
                    "=A1+B1",
                    "=SUM(A1+B1)",
                    "A1+B1",
                    "=ADD(A1,B1)",
                    "=A1&B1"
                ],
                correct: 0,
                explanation: "Gunakan operator + dengan tanda = di awal untuk penjumlahan sederhana"
            },
            {
                id: 2,
                question: "Untuk mengalikan sel A1 dengan B1, rumus yang tepat adalah:",
                options: [
                    "=A1xB1",
                    "=A1*B1",
                    "=MULTIPLY(A1,B1)",
                    "=A1√óB1",
                    "=PRODUCT(A1+B1)"
                ],
                correct: 1,
                explanation: "Operator perkalian di Excel menggunakan tanda asterisk (*)"
            },
            {
                id: 3,
                question: "Rumus untuk menjumlahkan sel A1 sampai A10 adalah:",
                options: [
                    "=A1+A2+A3+A4+A5+A6+A7+A8+A9+A10",
                    "=SUM(A1:A10)",
                    "=ADD(A1:A10)",
                    "=TOTAL(A1:A10)",
                    "=SUM(A1-A10)"
                ],
                correct: 1,
                explanation: "Fungsi SUM() dengan range A1:A10 adalah cara paling efisien"
            },
            {
                id: 4,
                question: "Untuk menjumlahkan data dari sheet lain (Sheet2 sel A1), rumus yang benar adalah:",
                options: [
                    "=SUM(Sheet2A1)",
                    "=Sheet2->A1",
                    "=Sheet2!A1",
                    "=Sheet2.A1",
                    "=A1[Sheet2]"
                ],
                correct: 2,
                explanation: "Gunakan tanda ! (exclamation mark) untuk mereferensi sheet lain"
            },
            {
                id: 5,
                question: "Rumus untuk menjumlahkan data dengan satu kriteria adalah:",
                options: [
                    "=SUM(IF)",
                    "=SUMIF(range,kriteria,sum_range)",
                    "=COUNTIF(range,kriteria)",
                    "=SUMCRITERIA(range,kriteria)",
                    "=SUM(range,kriteria)"
                ],
                correct: 1,
                explanation: "SUMIF digunakan untuk menjumlahkan dengan satu kriteria tertentu"
            },
            {
                id: 6,
                question: "Untuk menjumlahkan data dengan banyak kriteria, fungsi yang tepat adalah:",
                options: [
                    "=SUMIF()",
                    "=SUMIFS()",
                    "=COUNTIFS()",
                    "=SUMCRITERIA()",
                    "=SUMALL()"
                ],
                correct: 1,
                explanation: "SUMIFS memungkinkan penggunaan beberapa kriteria sekaligus"
            },
            {
                id: 7,
                question: "Rumus untuk membulatkan angka 15.678 menjadi 2 desimal adalah:",
                options: [
                    "=ROUND(15.678,2)",
                    "=ROUNDUP(15.678,2)",
                    "=INT(15.678)",
                    "=CEILING(15.678,2)",
                    "=TRUNC(15.678,2)"
                ],
                correct: 0,
                explanation: "ROUND(angka,jumlah_desimal) membulatkan secara matematis"
            },
            {
                id: 8,
                question: "Untuk menghilangkan angka di belakang koma dari 25.75, gunakan:",
                options: [
                    "=ROUND(25.75,0)",
                    "=INT(25.75)",
                    "=TRUNC(25.75)",
                    "=ROUNDDOWN(25.75,0)",
                    "Semua jawaban benar"
                ],
                correct: 4,
                explanation: "INT, TRUNC, ROUND, dan ROUNDDOWN dapat menghilangkan desimal"
            },
            {
                id: 9,
                question: "Rumus untuk membulatkan 23 ke kelipatan 5 terdekat adalah:",
                options: [
                    "=ROUND(23,5)",
                    "=MROUND(23,5)",
                    "=ROUNDUP(23,5)",
                    "=CEILING(23,5)",
                    "=MULTIPLE(23,5)"
                ],
                correct: 1,
                explanation: "MROUND membulatkan ke kelipatan tertentu (hasilnya 25)"
            },
            {
                id: 10,
                question: "Untuk membuat angka acak antara 1-100, rumus yang tepat adalah:",
                options: [
                    "=RANDOM(1,100)",
                    "=RAND()*100",
                    "=RANDBETWEEN(1,100)",
                    "=RND(1,100)",
                    "=RANDNUM(1,100)"
                ],
                correct: 2,
                explanation: "RANDBETWEEN menghasilkan bilangan bulat acak dalam range tertentu"
            },
            {
                id: 11,
                question: "Fungsi yang menghasilkan angka desimal acak antara 0 sampai 1 adalah:",
                options: [
                    "=RANDOM()",
                    "=RAND()",
                    "=RANDBETWEEN(0,1)",
                    "=RND()",
                    "=RANDOMIZE()"
                ],
                correct: 1,
                explanation: "RAND() menghasilkan angka desimal acak antara 0 dan 1"
            },
            {
                id: 12,
                question: "Untuk membuat angka random unik (tidak kembar), kombinasi fungsi yang digunakan:",
                options: [
                    "=RAND() + UNIQUE()",
                    "=RANDBETWEEN() dengan COUNTIF()",
                    "=UNIQUE(RANDBETWEEN())",
                    "=DISTINCT(RAND())",
                    "=RANDOMONCE()"
                ],
                correct: 1,
                explanation: "Kombinasi RANDBETWEEN dengan COUNTIF untuk cek duplikasi"
            },
            {
                id: 13,
                question: "Untuk membuat pola 1,1,1,2,2,2,3,3,3 di kolom, rumus yang tepat adalah:",
                options: [
                    "=INT((ROW()-1)/3)+1",
                    "=ROUNDUP(ROW()/3,0)",
                    "=CEILING(ROW()/3,1)",
                    "Semua jawaban A, B, dan C benar",
                    "=REPEAT(ROW(),3)"
                ],
                correct: 3,
                explanation: "Ketiga rumus tersebut menghasilkan pola yang sama"
            },
            {
                id: 14,
                question: "Untuk membuat pola 1,2,3,1,2,3,1,2,3, fungsi yang digunakan adalah:",
                options: [
                    "=MOD(ROW()-1,3)+1",
                    "=REPEAT(1,2,3)",
                    "=CYCLE(ROW(),3)",
                    "=INT(ROW()/3)",
                    "=SEQUENCE(ROW(),3)"
                ],
                correct: 0,
                explanation: "MOD menghasilkan sisa pembagian untuk pola berulang"
            },
            {
                id: 15,
                question: "Rumus untuk menghitung sisa pembagian 17 dibagi 5 adalah:",
                options: [
                    "=REMAINDER(17,5)",
                    "=MOD(17,5)",
                    "=17%5",
                    "=MODULUS(17,5)",
                    "Semua jawaban A dan B benar"
                ],
                correct: 4,
                explanation: "Baik MOD maupun REMAINDER dapat menghitung sisa pembagian"
            },
            {
                id: 16,
                question: "Hasil dari =MOD(20,6) adalah:",
                options: [
                    "3",
                    "2",
                    "4",
                    "6",
                    "14"
                ],
                correct: 1,
                explanation: "20 dibagi 6 = 3 sisa 2, jadi MOD(20,6) = 2"
            },
            {
                id: 17,
                question: "Untuk menghitung 25% dari nilai di sel A1, rumus yang benar adalah:",
                options: [
                    "=A1*25%",
                    "=A1*0.25",
                    "=A1/100*25",
                    "=PERCENTAGE(A1,25)",
                    "Semua jawaban A, B, dan C benar"
                ],
                correct: 4,
                explanation: "Ketiga cara tersebut menghasilkan hasil yang sama"
            },
            {
                id: 18,
                question: "Untuk menghitung persentase kenaikan dari 80 ke 100, rumusnya:",
                options: [
                    "=(100-80)/100*100%",
                    "=(100-80)/80*100%",
                    "=(100/80)*100%",
                    "=(100-80)*100%",
                    "=100/80-1"
                ],
                correct: 1,
                explanation: "Persentase kenaikan = (nilai baru - nilai lama) / nilai lama √ó 100%"
            },
            {
                id: 19,
                question: "Rumus untuk pembagian sel A1 dengan B1 yang benar adalah:",
                options: [
                    "=A1:B1",
                    "=A1√∑B1",
                    "=A1/B1",
                    "=DIVIDE(A1,B1)",
                    "=A1\\B1"
                ],
                correct: 2,
                explanation: "Operator pembagian di Excel menggunakan forward slash (/)"
            },
            {
                id: 20,
                question: "Untuk menjumlahkan sel B2 dari Sheet1, Sheet2, dan Sheet3, rumus 3D yang tepat adalah:",
                options: [
                    "=SUM(Sheet1:Sheet3!B2)",
                    "=SUM(Sheet1,Sheet2,Sheet3!B2)",
                    "=Sheet1!B2+Sheet2!B2+Sheet3!B2",
                    "Jawaban A dan C benar",
                    "=SUM(Sheet1-Sheet3!B2)"
                ],
                correct: 3,
                explanation: "Bisa menggunakan rumus 3D atau penjumlahan eksplisit"
            }
        ];

        let userAnswers = {};

        async function onConfigChange(config) {
            const app = document.getElementById('app');
            const bgColor = config.background_color || defaultConfig.background_color;
            const cardBg = config.card_background || defaultConfig.card_background;
            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const textColor = config.text_color || defaultConfig.text_color;
            const accentColor = config.accent_color || defaultConfig.accent_color;
            const title = config.quiz_title || defaultConfig.quiz_title;
            const subtitle = config.quiz_subtitle || defaultConfig.quiz_subtitle;

            document.body.style.backgroundColor = bgColor;

            app.innerHTML = `
                <div style="background-color: ${bgColor}; min-height: 100%; padding: 24px;">
                    <div style="max-width: 900px; margin: 0 auto;">
                        <!-- Header -->
                        <div style="background-color: ${primaryColor}; color: white; padding: 32px; border-radius: 16px; margin-bottom: 32px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <h1 style="font-size: 32px; font-weight: bold; margin: 0 0 12px 0;">${title}</h1>
                            <p style="font-size: 18px; margin: 0; opacity: 0.95;">${subtitle}</p>
                            <div style="margin-top: 20px; padding: 16px; background-color: rgba(255,255,255,0.15); border-radius: 8px;">
                                <p style="margin: 0; font-size: 16px;">üìä Total Soal: <strong>20</strong> | ‚è±Ô∏è Tidak ada batas waktu | ‚úÖ Jawaban langsung ditampilkan</p>
                            </div>
                        </div>

                        <!-- Questions -->
                        <div id="questions-container"></div>

                        <!-- Score Summary -->
                        <div id="score-summary" style="background-color: ${cardBg}; padding: 24px; border-radius: 12px; margin-top: 32px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: none;">
                            <h2 style="color: ${primaryColor}; font-size: 24px; margin: 0 0 16px 0;">üìà Ringkasan Nilai</h2>
                            <div id="score-content"></div>
                        </div>
                    </div>
                </div>
            `;

            const questionsContainer = document.getElementById('questions-container');
            
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card fade-in';
                questionDiv.style.cssText = `
                    background-color: ${cardBg};
                    padding: 24px;
                    border-radius: 12px;
                    margin-bottom: 24px;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                `;

                let optionsHTML = '';
                q.options.forEach((option, optIndex) => {
                    optionsHTML += `
                        <button 
                            class="option-button"
                            data-question="${q.id}"
                            data-option="${optIndex}"
                            style="
                                width: 100%;
                                text-align: left;
                                padding: 16px;
                                margin: 8px 0;
                                border: 2px solid #e2e8f0;
                                border-radius: 8px;
                                background-color: white;
                                color: ${textColor};
                                font-size: 16px;
                                cursor: pointer;
                            ">
                            <span style="font-weight: bold; color: ${accentColor};">${String.fromCharCode(65 + optIndex)}.</span> ${option}
                        </button>
                    `;
                });

                questionDiv.innerHTML = `
                    <div style="display: flex; align-items: start; margin-bottom: 20px;">
                        <div style="background-color: ${primaryColor}; color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px; flex-shrink: 0; margin-right: 16px;">
                            ${index + 1}
                        </div>
                        <h3 style="color: ${textColor}; font-size: 18px; font-weight: 600; margin: 6px 0 0 0; line-height: 1.5;">
                            ${q.question}
                        </h3>
                    </div>
                    <div class="options-container">
                        ${optionsHTML}
                    </div>
                    <div id="feedback-${q.id}" style="margin-top: 16px; padding: 16px; border-radius: 8px; display: none;"></div>
                `;

                questionsContainer.appendChild(questionDiv);
            });

            // Add event listeners
            document.querySelectorAll('.option-button').forEach(button => {
                button.addEventListener('click', (e) => handleAnswer(e, primaryColor, accentColor, textColor));
            });

            updateScoreSummary(primaryColor, accentColor, cardBg);
        }

        function handleAnswer(e, primaryColor, accentColor, textColor) {
            const button = e.currentTarget;
            const questionId = parseInt(button.dataset.question);
            const selectedOption = parseInt(button.dataset.option);
            const question = questions.find(q => q.id === questionId);

            // Prevent multiple answers
            if (userAnswers[questionId] !== undefined) return;

            userAnswers[questionId] = selectedOption;
            const isCorrect = selectedOption === question.correct;

            // Disable all options for this question
            const allOptions = document.querySelectorAll(`[data-question="${questionId}"]`);
            allOptions.forEach(opt => {
                opt.disabled = true;
                opt.classList.add('disabled-option');
                const optIndex = parseInt(opt.dataset.option);
                
                if (optIndex === question.correct) {
                    opt.classList.add('correct-answer');
                } else if (optIndex === selectedOption && !isCorrect) {
                    opt.classList.add('wrong-answer');
                }
            });

            // Show feedback
            const feedback = document.getElementById(`feedback-${questionId}`);
            feedback.style.display = 'block';
            feedback.style.backgroundColor = isCorrect ? '#d1fae5' : '#fee2e2';
            feedback.style.borderLeft = `4px solid ${isCorrect ? '#10b981' : '#ef4444'}`;
            feedback.innerHTML = `
                <div style="font-weight: bold; color: ${isCorrect ? '#065f46' : '#991b1b'}; margin-bottom: 8px; font-size: 16px;">
                    ${isCorrect ? '‚úÖ Benar!' : '‚ùå Kurang Tepat'}
                </div>
                <div style="color: ${textColor}; line-height: 1.6;">
                    <strong>Penjelasan:</strong> ${question.explanation}
                    ${!isCorrect ? `<br><strong>Jawaban yang benar:</strong> ${String.fromCharCode(65 + question.correct)}. ${question.options[question.correct]}` : ''}
                </div>
            `;

            updateScoreSummary(primaryColor, accentColor, '#ffffff');
        }

        function updateScoreSummary(primaryColor, accentColor, cardBg) {
            const answeredCount = Object.keys(userAnswers).length;
            if (answeredCount === 0) return;

            const correctCount = Object.entries(userAnswers).filter(([qId, answer]) => {
                const question = questions.find(q => q.id === parseInt(qId));
                return answer === question.correct;
            }).length;

            const percentage = Math.round((correctCount / answeredCount) * 100);

            const scoreSummary = document.getElementById('score-summary');
            const scoreContent = document.getElementById('score-content');
            
            scoreSummary.style.display = 'block';
            scoreSummary.style.backgroundColor = cardBg;
            
            let resultMessage = '';
            let resultColor = '';
            
            if (percentage >= 80) {
                resultMessage = 'üéâ Luar Biasa!';
                resultColor = '#10b981';
            } else if (percentage >= 60) {
                resultMessage = 'üëç Bagus!';
                resultColor = '#3b82f6';
            } else if (percentage >= 40) {
                resultMessage = 'üìö Terus Belajar!';
                resultColor = '#f59e0b';
            } else {
                resultMessage = 'üí™ Jangan Menyerah!';
                resultColor = '#ef4444';
            }

            scoreContent.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                    <div style="background-color: #f0f9ff; padding: 16px; border-radius: 8px; border-left: 4px solid ${primaryColor};">
                        <div style="font-size: 14px; color: #64748b; margin-bottom: 4px;">Soal Dijawab</div>
                        <div style="font-size: 28px; font-weight: bold; color: ${primaryColor};">${answeredCount} / 20</div>
                    </div>
                    <div style="background-color: #f0fdf4; padding: 16px; border-radius: 8px; border-left: 4px solid #10b981;">
                        <div style="font-size: 14px; color: #64748b; margin-bottom: 4px;">Jawaban Benar</div>
                        <div style="font-size: 28px; font-weight: bold; color: #10b981;">${correctCount}</div>
                    </div>
                    <div style="background-color: ${resultColor}15; padding: 16px; border-radius: 8px; border-left: 4px solid ${resultColor};">
                        <div style="font-size: 14px; color: #64748b; margin-bottom: 4px;">Nilai</div>
                        <div style="font-size: 28px; font-weight: bold; color: ${resultColor};">${percentage}%</div>
                    </div>
                </div>
                <div style="margin-top: 16px; padding: 16px; background-color: ${resultColor}15; border-radius: 8px; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: ${resultColor};">${resultMessage}</div>
                </div>
            `;
        }

        // Initialize SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.card_background || defaultConfig.card_background,
                            set: (value) => {
                                config.card_background = value;
                                window.elementSdk.setConfig({ card_background: value });
                            }
                        },
                        {
                            get: () => config.primary_color || defaultConfig.primary_color,
                            set: (value) => {
                                config.primary_color = value;
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        },
                        {
                            get: () => config.text_color || defaultConfig.text_color,
                            set: (value) => {
                                config.text_color = value;
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        },
                        {
                            get: () => config.accent_color || defaultConfig.accent_color,
                            set: (value) => {
                                config.accent_color = value;
                                window.elementSdk.setConfig({ accent_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["quiz_title", config.quiz_title || defaultConfig.quiz_title],
                    ["quiz_subtitle", config.quiz_subtitle || defaultConfig.quiz_subtitle]
                ])
            });

            onConfigChange(window.elementSdk.config);
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ac16228a3327324',t:'MTc2NTQxODM3NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
